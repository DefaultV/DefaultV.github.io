var r=document.getElementById("renderCanvas"),n=new BABYLON.Engine(r,!0,{adaptToDeviceRatio:!0}),e=function(e,t,r){for(var n=t.path,i=t.profile,a=Number.MAX_VALUE,o=0;o<i.length;o++)a=Math.min(a,i[o].x);var B,l=[],h=n.length,c=BABYLON.Vector3.Zero(),s=BABYLON.Vector3.Zero();n[1].subtractToRef(n[0],c),n[2].subtractToRef(n[1],s);for(var u=0;u<h;u++){var A=Math.PI-Math.acos(BABYLON.Vector3.Dot(c,s)/(c.length()*s.length())),g=BABYLON.Vector3.Cross(c,s).normalize().z,L=new BABYLON.Vector3(c.y,-1*c.x,0).normalize();c.normalize(),c.length();for(l[(u+1)%h]=[],o=0;o<i.length;o++)B=i[o].x-a,l[(u+1)%h].push(n[(u+1)%h].subtract(L.scale(B)).subtract(c.scale(g*B/Math.tan(A/2))));c=s.clone(),n[(u+3)%h].subtractToRef(n[(u+2)%h],s)}for(var d=[],w=[],u=0;u<h;u++){for(w=[],o=0;o<i.length;o++)w[o]=[],w[o].push(new BABYLON.Vector3(l[u][o].x,l[u][o].y,i[o].y)),w[o].push(new BABYLON.Vector3(l[(u+1)%h][o].x,l[(u+1)%h][o].y,i[o].y));d[u]=BABYLON.MeshBuilder.CreateRibbon("frameLeft",{pathArray:w,sideOrientation:BABYLON.Mesh.BACKSIDE,updatable:!0,closeArray:!1},r)}return BABYLON.Mesh.MergeMeshes(d,!0).convertToFlatShadedMesh()},t=function(){var e=new BABYLON.Scene(n),t=(e.clearColor=BABYLON.Color4.FromHexString("#333333ff"),new BABYLON.ArcRotateCamera("camera",.5*-Math.PI,.45*Math.PI,1,BABYLON.Vector3.Zero()));t.setTarget(BABYLON.Vector3.Zero()),t.attachControl(r,!1),t.zoomToMouseLocation=!0,t.minZ=.01,t.wheelDeltaPercentage=.025,t.pinchPrecision=500,t.panningSensibility=4e3,t.lowerRadiusLimit=.05,t.upperRadiusLimit=2,t.checkCollisions=!0,t.collisionRadius=new BABYLON.Vector3(.025,.025,.025);new BABYLON.HemisphericLight("hlight",new BABYLON.Vector3(0,1,0),e).intensity=2,new BABYLON.DirectionalLight("light1",new BABYLON.Vector3(0,.25,.75),e);return e},i=t(),a=(n.runRenderLoop(function(){i.render()}),window.addEventListener("resize",function(){n.resize()}),.5),o=.01*a,B=[new BABYLON.Vector3(-a,-a,0),new BABYLON.Vector3(a,-a,0),new BABYLON.Vector3(a,a,0),new BABYLON.Vector3(-a,a,0)],l=[new BABYLON.Vector3(-o,o,0),new BABYLON.Vector3(-o,-o,0)],h=[{textureUrl:"res/painting.webp",width:.4,height:.5},{textureUrl:"res/painting4.webp",width:.9,height:.4},{textureUrl:"res/painting2.webp",width:.4,height:.5},{textureUrl:"res/painting5.webp",width:.4,height:.4},{textureUrl:"res/painting3.webp",width:.4,height:.5},{textureUrl:"res/painting6.webp",width:.4,height:.3},{textureUrl:"res/painting7.webp",width:.4,height:.5},{textureUrl:"res/painting9.webp",width:.4,height:.3},{textureUrl:"res/painting8.webp",width:.4,height:.5}],c=0,s=e("frame",{path:B,profile:l},i),u=BABYLON.MeshBuilder.CreatePlane("artworkcanvas",{width:1,height:1}),A=BABYLON.MeshBuilder.CreatePlane("artworkcanvas",{width:1,height:1,sideOrientation:BABYLON.Mesh.BACKSIDE}),g=(u.checkCollisions=!0,u.position.z=-o,u.material=new BABYLON.StandardMaterial("canvas_mat"),u.material.specularColor=BABYLON.Color3.FromHexString("#333333"),A.material=new BABYLON.StandardMaterial("canvasBack_mat"),A.material.specularColor=BABYLON.Color3.FromHexString("#333333"),A.material.diffuseTexture=new BABYLON.Texture("res/artwork_back.webp"),new BABYLON.CubicEase),L=(g.setEasingMode(BABYLON.EasingFunction.EASINGMODE_EASEINOUT),function(t){BABYLON.Animation.CreateAndStartAnimation("anim",u,"visibility",2,1,0,1,0,g),BABYLON.Animation.CreateAndStartAnimation("anim",s,"visibility",2,1,0,1,0,g),u.material.diffuseTexture=new BABYLON.Texture(t.textureUrl),[s,u,A].forEach(function(e){e.scaling.x=t.width,e.scaling.y=t.height,e.position.y=.5*t.height})}),d=(L(h[c]),i.activeCamera.target.y=.5*h[c].height,function(e){return h[e]?h[c=e]:h[c]}),w=document.getElementById("nav-left"),O=document.getElementById("nav-right");null!=O&&O.addEventListener("click",function(){var e=d(c+1);L(e)}),null!=w&&w.addEventListener("click",function(){var e=d(c-1);L(e)}),i.createDefaultEnvironment({skyboxColor:BABYLON.Color3.FromHexString("#eeeeee"),groundColor:BABYLON.Color3.FromHexString("#eeeeee"),enableGroundMirror:!0,groundMirrorAmount:.2,rootPosition:BABYLON.Vector3.ZeroReadOnly});
