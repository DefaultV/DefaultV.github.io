var t=document.getElementById("renderCanvas"),o=new BABYLON.Engine(t,!0,{adaptToDeviceRatio:!0}),e=function(e,r,t){for(var o=r.path,n=r.profile,a=Number.MAX_VALUE,i=0;i<n.length;i++)a=Math.min(a,n[i].x);var B,l=[],c=o.length,s=BABYLON.Vector3.Zero(),L=BABYLON.Vector3.Zero();o[1].subtractToRef(o[0],s),o[2].subtractToRef(o[1],L);for(var h=0;h<c;h++){var A=Math.PI-Math.acos(BABYLON.Vector3.Dot(s,L)/(s.length()*L.length())),u=BABYLON.Vector3.Cross(s,L).normalize().z,N=new BABYLON.Vector3(s.y,-1*s.x,0).normalize();s.normalize(),s.length();for(l[(h+1)%c]=[],i=0;i<n.length;i++)B=n[i].x-a,l[(h+1)%c].push(o[(h+1)%c].subtract(N.scale(B)).subtract(s.scale(u*B/Math.tan(A/2))));s=L.clone(),o[(h+3)%c].subtractToRef(o[(h+2)%c],L)}for(var O=[],Y=[],h=0;h<c;h++){for(Y=[],i=0;i<n.length;i++)Y[i]=[],Y[i].push(new BABYLON.Vector3(l[h][i].x,l[h][i].y,n[i].y)),Y[i].push(new BABYLON.Vector3(l[(h+1)%c][i].x,l[(h+1)%c][i].y,n[i].y));O[h]=BABYLON.MeshBuilder.CreateRibbon("frameLeft",{pathArray:Y,sideOrientation:BABYLON.Mesh.BACKSIDE,updatable:!0,closeArray:!1},t)}return BABYLON.Mesh.MergeMeshes(O,!0).convertToFlatShadedMesh()},r=function(){var e=new BABYLON.Scene(o),r=(e.clearColor=BABYLON.Color4.FromHexString("#333333ff"),new BABYLON.ArcRotateCamera("camera",.5*-Math.PI,.45*Math.PI,1,BABYLON.Vector3.Zero()));r.setTarget(BABYLON.Vector3.Zero()),r.attachControl(t,!1),r.zoomToMouseLocation=!0,r.minZ=.01,r.wheelDeltaPercentage=.025,r.pinchPrecision=200,r.panningSensibility=4e3,r.upperAlphaLimit=0,r.lowerAlphaLimit=-Math.PI,r.lowerRadiusLimit=.05,r.upperRadiusLimit=2,r.checkCollisions=!0,r.collisionRadius=new BABYLON.Vector3(.025,.025,.025);new BABYLON.HemisphericLight("hlight",new BABYLON.Vector3(0,1,0),e).intensity=1,new BABYLON.DirectionalLight("light1",new BABYLON.Vector3(0,.25,.75),e);return e},n=r(),a=(o.runRenderLoop(function(){n.render()}),window.addEventListener("resize",function(){o.resize()}),.5),i=.01*a,B=[new BABYLON.Vector3(-a,-a,0),new BABYLON.Vector3(a,-a,0),new BABYLON.Vector3(a,a,0),new BABYLON.Vector3(-a,a,0)],l=[new BABYLON.Vector3(-i,i,0),new BABYLON.Vector3(-i,-i,0)],c=e("line",{path:B,profile:l},n),s=BABYLON.MeshBuilder.CreatePlane("artworkcanvas",{width:.4,height:.5});s.position.z=-i,s.material=new BABYLON.StandardMaterial("canvas_mat"),s.material.diffuseTexture=new BABYLON.Texture("res/painting.jpg"),s.material.specularColor=BABYLON.Color3.FromHexString("#333333"),c.scaling.x=.4,c.scaling.y=.5,s.checkCollisions=!0,n.createDefaultEnvironment({skyboxColor:BABYLON.Color3.FromHexString("#333333"),groundColor:BABYLON.Color3.FromHexString("#333333"),enableGroundMirror:!0,groundMirrorAmount:.25});
